
#+TITLE:     as同后台服务通信协议
#+AUTHOR:    monster@taomee
#+DESCRIPTION: 
#+KEYWORDS: 
#+LANGUAGE:  zh
#+OPTIONS:   ^:nil d:nil skip:nil pri:nil tags:not-in-toc LaTeX:nul TeX:nil toc:2 H:2
#+STARTUP:   content
#+INFOJS_OPT: view:content tdepth:nil ltoc:nil path:http://10.1.1.28/smyang/org-info.js

* 协议类型定义
** 101--104 as同主登录login之间的通信协议
| 协议号 | 说明               |
|--------+--------------------|
|    101 | 重新生成验证码图片 |
|    102 | 查询游戏是否激活   |
|    103 | 用户登录           |
|    104 | 用激活码激活游戏           | 
  
** 110 -- 120 as同副login之间的通信协议
| 协议号 | 说明 |
|--------+------|
| 110    | as向login请求单个online服务器ip和port|

** 40001 --- 40100 as以及online同share-server之间的通信协议
| 协议号 | 说明                             |
|--------+----------------------------------|
|  40001 | online告知share-server有用户登录 |
|  40002 | as向share-server请求最近登录用户   |


** 40101 -- 42000 as同online之间的通信协议
| 协议号 | 说明                             |
|--------+----------------------------------|
|  40101 | as向onlne发注册信息
|  40102 | as向online发登录信息                   |


* 请求包头
| 名称      | 类型   | 字节数 | 说明             |
|-----------+--------+--------+------------------|
| len       | uint32 |      4 | 消息长度         |
| type      | uint16 |      2 | 协议类型         |
| user_id   | uint32 |      4 | 用户米米号       |
| result    | uint32 |      4 | 暂时未用        |
| err_no    | uint32 |      4 | 错误码           |

* 包体
** as向主login发重新生成验证码图片协议:101
*** 请求包
| 名称 | 字节数 | 类型 | 说明 |
|------+--------+------+------|
| flag |  4     | uint32 | 0:正常登录 1：使用激活码时 |
*** 应答包
| 名称    |  字节数 | 类型      | 说明                                                                  |
|---------+---------+-----------+-----------------------------------------------------------------------|
| flag    |       4 | uint32    | 0不需要输入验证码，1需要输入验证码。仅当Flag==1时，才会发送下面的内容 |
| imgid   |      16 | uint8(16) | 图片ID。发送验证码时，需要把这个ID带上                                |
| imgsize |       4 | uint32    | 图片大小(字节)                                                        |
| img     | imgsize | uint8()   | Png格式图片，大小由ImgSize指定                                                                      |
1、用户输入了米米号/邮件地址后，点击输入密码框时；通过此协议询问服务器是否需要输入验证码
2、验证码看不清楚时，通过此协议请求服务器重新生成一个验证码

** as向主login查询游戏是否激活: 102
*** 请求包
| 名称      | 字节数 | 类型 | 说明 |
|-----------+--------+------+------|
| whichgame |  4     | uint32 |  13:小怪兽  |
 
*** 应答包
| 名称 | 字节数 | 类型 | 说明 |
|------+--------+------+------|
| flag |   4    | uint32 | 0:未激活 1：已激活 |

** as向主login发用户登录协议:103
*** 请求包(包头的userid字段不为0)
| 名称      | 字节数 | 类型      | 说明                                                       |
|-----------+--------+-----------+------------------------------------------------------------|
| password  |     32 | uint8(32) | 用户密码, MD5加密2次                                       |
| channel   |      4 | uint32    | 登录渠道                                                   |
| whichgame |      4 | uint32    | 13:小怪兽                                                  |
| ip        |      4 | uint32    | IP(如果时大玩国等php页面就填写用户外网地址，其他的游戏填0) |
| imgid     |     16 | uint8(16) | 101/103协议返回的图片id.如果不需要验证码，16个字节全部填0  |
| verigcode |     6  | uint8(6)  | 验证码(3到5个字符，余下的填0).如果不需要验证码，6个字节全部填0                        |
*** 请求包(包头的userid字段为0)
| 名称      | 字节数 | 类型      | 说明                                                           |
|-----------+--------+-----------+----------------------------------------------------------------|
| email     |     64 | char(64)  | 用户的email地址                                                     |
| password  |     32 | uint8(32) | 用户密码, MD5加密2次                                           |
| channel   |      4 | uint32    | 登录渠道                                                       |
| whichgame |      4 | uint32    | 13:小怪兽                                                      |
| ip        |      4 | uint32    | IP(如果时大玩国等php页面就填写用户外网地址，其他的游戏填0)     |
| imgid     |     16 | uint8(16) | 101/103协议返回的图片id.如果不需要验证码，16个字节全部填0      |
| verigcode |      6 | uint8(6)  | 验证码(3到5个字符，余下的填0).如果不需要验证码，6个字节全部填0 |

*** 应答包
***** 登录成功
| 名称        | 字节数 | 类型      | 说明 |
|-------------+--------+-----------+------|
| flag        |      4 | uint32    | 0表示登录成功 |
| session     |     16 | uint8(16) | 登录online用的session |
| rolecreated |      4 | uint32    | 该游戏的角色是否已创建（0-没创建 1-已创建） |

***** 登录失败(需要输入验证码)
| 名称    |  字节数 | 类型           | 说明 |
|---------+---------+----------------+------|
| flag    |       4 | uint32         | 1:密码错误 请输入验证码 2:验证码输入错误 3:米米号不存在 4：米米号被封停 5：系统错误 |
| imgid   |      16 | uint8(16)      | 图片ID。发送验证码时，需要把这个ID带上     |
| imgsize |       4 | uint32         | 图片大小（字节）     |
| img     | imgsize | uint8(imgsize) | Png格式图片，大小由ImgSize指定     |
备注:用户登录时，如果服务端发现同一个ip或者米米号一段时间内密码输错次数过多，会返回这个协议请求用户输入验证码。如果用户输入验证码错误，同样也会返回这个协议，请求用户重新输入。

***** 异地登录
| 名称               | 字节数 | 类型      | 说明                                                                 |
|--------------------+--------+-----------+----------------------------------------------------------------------|
| flag               |      4 | uint32    | 6:登录成功，但异地登录 7：登录成功，但异地登录次数过多，提醒修改密码 |
| session            |     16 | uint8(16) | 登录online用的session                                                |
| rolecreated        |      4 | uint32    | 该游戏的角色是否已创建(0-未创建 10已创建)                            |
| last_login_ip      |      4 | uint32    | 上次登录ip                                                           |
| last_login_time    |      4 | uint32    | 上次登录时间                                                         |
| last_login_city    |     64 | char(64)  | 上次登录城市，字符串形式,如"上海市" "浙江省 杭州市"                  |
| current_login_city |     64 | char(64)  | 本次登录城市                                                               |

** as向主login发用激活码激活游戏的协议:104
*** 请求包
| 名称        | 字节数 | 类型      | 说明                                              |
|-------------+--------+-----------+---------------------------------------------------|
| whichgame   |      4 | uint32    | 13:小怪兽                                         |
| active_code |     10 | char(10)  | 激活码：6-8个0-9、A-Z、a-z字符，没有用到的字节填0 |
| img_id      |     16 | uint8(16) | 101/103协议返回的图片ID。如果不需要输入验证码，则16个字节都填数字0 |
| verifcode   |     6  | uint8(6)  | 验证码（3到5个字符，余下字节填数字0） 如果不需要输入验证码，则6个字节都填数字0|
                                    
*** 应答包
| 名称    |  字节数 | 类型           | 说明 |
|---------+---------+----------------+------|
| flag    |       4 | uint32         | 0:表示激活成功，不会发送下面的内容 1:激活码错误次数过多，需要输入验证码后再激活 2:验证码输入错误  |
| imgid   |      16 | uint8(16)      | 图片ID。发送验证码时，需要把这个ID带上     |
| imgsize |       4 | uint32         |  图片大小（字节）    |
| img     | imgsize | uitn8(imgsize) |  Png格式图片，大小由ImgSize指定    |

*** 错误码(对应101-104协议)
| 错误码 | 描述                           |
|--------+--------------------------------|
|   5001 | 系统错误                       |
|   5002 | 用户帐号被冻结                 |
|   5003 | 密码错误                           |
|   5004 | 号码尚未激活                   |
|   5005 | 号码不存在                     |
|   5006 | 号码被永久封停（副登录在用）   |
|   5007 | 号码被24小时封停（副登录在用） |
|   5009 | 密码输错次数太多               |
|   5010 | 激活码错误                     |
|   5011 | 服务器维护                     |
|   5012 | 非法的邀请码（副登录在用）     |
     
** as向login请求单个online服务器: 110
*** 请求包
空 

*** 应答包
| 名称        | 类型     | 字节数 | 说明           |
|-------------+----------+--------+----------------|
| online_ip   | char(16) |     16 | online服务器IP |
| online_port | uint16   |      2 | online服务器port  |

** online告知share-server有用户登录游戏: 40001
*** 请求包
| 名称   | 类型     | 字节数 | 说明                 |
|--------+----------+--------+----------------------|
| gender | uint8    |      1 | 性别(0:女性 1：男性)        |
| name   | char(16) |     16 | 用户昵称             |

*** 应答包
无需应答online

** as向share-server请求最近登录用户信息: 40002
*** 请求包
空
*** 应答包
| 名称           | 类型     | 字节数 | 说明                     |
|----------------+----------+--------+--------------------------|
| active_num     | uint16   |      2 | 活跃用户数量(不会超过50个)    |
| ....           | ....     |   .... | ....                     |
| user_id        | uint32   |      4 | 用户米米号               |
| name           | char(16) |     16 | 用户昵称                 |
| gender         | uint8    |      1 | 用户性别(0:女性 1：男性) |



** as向online发注册信息: 40101
*** 请求包
| 名称           | 类型     | 字节数 | 说明                 |
|----------------+----------+--------+----------------------|
| name           | char(16) |     16 | 用户昵称             |
| gender         | uint8    |      1 | 性别(0:女性 1：男性) |
| country_id     | uint16   |      2 | 国籍id               |
| birthday       | uint32   |      4 | 生日,格式:19901123   |
| mon_id         | uint32   |      4 | 怪兽id               |
| mon_name       | char(16) |     16 | 怪兽昵称             |
| mon_main_color | uint32   |      4 | 怪兽主颜色           |
| mon_exp_color  | uint32   |      4 | 怪兽辅颜色           |
| mon_eye_color  | uint32   |      4 | 怪兽眼睛颜色         |
| invitor_id     | uint32   |      4 | 邀请人米米号(没人邀请填写0)      |

*** 应答包
| name                               | char(16) | 16 | 用户昵称                                                     |   |   |   |
| gender                             | uint8    |  1 | 用户性别(0:女性 1：男性)                                     |   |   |   |
| country_id                         | uint32   |  4 | 国籍id                                                       |   |   |   |
| user_type                          | uint8    |  1 | (0:普通用户 1：vip用户 2:gm用户)                             |   |   |   |
| birthday                           | uint32   |  4 | 生日，格式(20110723)                                         |   |   |   |
| mood                               | uint8    |  1 | 用户心情                                                     |   |   |   |
| fav_color                          | uint8    |  1 | 用户最爱的颜色                                               |   |   |   |
| fav_pet                            | uint8    |  1 | 用户最爱的精灵                                               |   |   |   |
| fav_fruit                          | uint8    |  1 | 用户最爱的水果                                               |   |   |   |
| personal_sign                      | char(64) | 64 | 用户个性签名                                                 |   |   |   |
| room_num                           | uint8    |  1 | 用户房间数量                                                 |   |   |   |
| pet_num                            | uint8    |  1 | 用户精灵个数                                                 |   |   |   |
| max_puzzle_score                   | uint16   |  2 | 益智游戏最高分                                               |   |   |   |
| register_time                      | uint32   |  4 | 注册时间                                                     |   |   |   |
| coins                              | uint32   |  4 | 金币数                                                       |   |   |   |
| last_login_time                    | uint32   |  4 | 上次登录时间                                                 |   |   |   |
| is_first_login                     | uint32   |  4 | 今天是否第一次登陆0：否 1：是                                    |   |   |   |
| mon_id                             | uint32   |  4 | 怪兽id                                                       |   |   |   |
| mon_name                           | char(16) | 16 | 怪兽昵称                                                     |   |   |   |
| mon_main_color                     | uint32   |  4 | 怪兽主颜色                                                   |   |   |   |
| mon_exp_color                      | uint32   |  4 | 怪兽辅颜色                                                   |   |   |   |
| mon_eye_color                      | uint32   |  4 | 怪兽眼睛颜色                                                 |   |   |   |
| mon_exp                            | uint32   |  4 | 怪兽经验值                                                   |   |   |   |
| mon_level                          | uint16   |  2 | 怪兽等级                                                     |   |   |   |
| mon_health                         | uint32   |  4 | 怪兽健康值                                                   |   |   |   |
| mon_happy                          | uint32   |  4 | 怪兽愉悦度                                                   |   |   |   |
| approved_message_num               | uint32   |  4 | 已审核的留言数量                                             |   |   |   |
| unapproved_message_num             | uint32   |  4 | 未审核的留言数量                                             |   |   |   |
| friend_total                       | uint16   |  2 | 好友总数                                                     |   |   |   |
| pending_req                        | uint8    |  1 | 是否有未处理的好友请求(0:没有 1：有)                         |   |   |   |
| thumb                              | uint32   |  4 | 小屋被顶的次数                                               |   |   |   |
| visits                             | uint32   |  4 | 小屋的访问次数                                               |   |   |   |
| recent_badge                       | uint6    |  2 | 未查看的最近获得的成就数                                     |   |   |   |
| npc_cur_score                      | uint32   |  4 | 当前npc给出的得分                                            |   |   |   |
| following_pet_num                  | uint8    |  1 | 跟随的小怪兽数量                                             |   |   |   |
| 下面是每个小怪收的id               |          |    |                                                              |   |   |   |
| pet_id                             | uint32   |  4 | 小怪兽id                                                     |   |   |   |
| 下面的数据只有获取自己信息时菜返回 |          |    |                                                              |   |   |   |
| flag1                              | uint32   |  4 | 用于新手引导的标志位                                         |   |   |   |
| recent_visit                       | uint16   |  2 | 未查看的最近来访或顶的用户数                                 |   |   |   |
| bobo_flag                          | uint8    |  1 | 卜卜报是否领奖(0:未读  1:已读未领奖 2:已读已领奖)            |   |   |   |
| online_time                        | uint32   |  4 | 放成谜的时间                                                 |   |   |   |
| limited_reward                     | uint8    |  1 | 是否有封测大礼(0:没有 1：封测大礼海报 2：封测大礼海报加雕像) |   |   |   |

** as向online发起登录信息: 40102
*** 请求包
| 名称    | 类型 | 字节数 | 说明 |
|---------+------+--------+------|
| session | char(16)  | 16     | 从login服务器获取到的session |

*** 应答包
| 名称        | 类型   | 字节数 | 说明                                 |
|-------------+--------+--------+--------------------------------------|
| is_register | uint8  |      1 | 是否注册用户(0:未注册  1:已注册用户) |
| guide_flag  | uint32 |      4 | 强制引导标识                               |
未注册用户没有下面数据;已注册用户同40101
*** 错误码
| 100201:给account平台发送验证消息失败          |
| 200015:用户的session不能通过account平台的验证 |
|                                               |

** 拉取背包中的物品: 40103
*** 请求包 
空 

*** 应答包
| count     | uint16 | 2 | 物品总数量 |
| ...       |        |   |            |
| stuff_id  | uint32 | 4 | 物品id     |
| stuff_num | uint16 | 2 | 物品数量   |
| category  | uint8  |   | 物品的类别      |
*** 错误码
| 100827:物品id不存在 |
|                     |

** 拉取房间信息: 40104
*** 请求包
| user_id | uint32 | 4 | 用户id   |
| room_id | uint32 | 4 | 房间id |

*** 应答包
| buf | char(0) | 长度不固定 | buf内容|
*** 错误码
| 100019:数据库里找不到对应的房间信息 |
|                                     |

** 更新房间buf信息: 40105
*** 请求包
| room_id | uint32 | 4 | 房间id |
| buf     | char(0) | 不定长 |        |

*** 应答包
空
*** 错误码
     | 100801：解析用户的房间buf失败        |
     | 100803：缓存里找不到用户老的房间buf  |
     | 100806：缓存里找不到用户的背包信息   |
     | 100808：要更新的房间buf不合法        |
     | 100836：保存用户要更新的房间信息失败 |
     |                                      |


** 拉取个数信息: 40106
*** 请求包
空
*** 应答包
| room_num | uint16 | 2 | 房间总个数 |
| ...      |        |   |            |
| room_id  | uint32 | 4 | 房间id       |

** 添加新房间: 40107(房间的个数有上限)
*** 请求包

*** 应答包
| room_id  | uint32 | 4 | 新房间id |
| room_buf | char(0) | 不定长 | 初始房间buf  |

** 购买商品: 40108
*** 请求包
| stuff_id  | uint32 | 4 | 商品id |
| stuff_num | uint16 | 2 | 本次购买的商品数量 | 

*** 应答包
| stuff_id   | uint32 | 4 | 购买成功的商品id |
| category   | uint8  | 1 | 物品的种类       |
| reward_exp | uint16 | 2 | 奖励的经验值           |

*** 错误码
   | 100827：购买的物品id不存在                             |
   | 100811：不符合购买物品的条件限制（金币不够或等级不够） |
   |                                                        |

** 拉取益智游戏信息: 40109
*** 请求包
空 

*** 应答包
| count     | uint16 | 2 | 游戏信息的数量                                 |
|-----------+--------+---+------------------------------------------------|
| ...       |        |   |                                                |
| type      | uint8  | 1 | 游戏类型(0:每日挑战 >0:单个游戏挑战所属的类型) |
| is_played | uint8  | 1 | 当天是否挑战过                                 |
| daily_max | uint16 | 2 | 最高分                                         |
| daily_avg | uint16 | 2 | 平均分                                            |
*** 错误码
 | 100007：未知的系统错误(转换时间戳出错) |
 |                                        |

** 提交益智游戏结果: 40110
*** 请求包:
| type      | uint8  | 1 | 游戏类型     |
| total_num | uint16 | 2 | 总共答题数量 |
| right_num | uint16 | 2 | 答对的题目的数量     |

*** 应答包
| type          | uint8  | 1 | 游戏类型                           |
| reward_coins  | uint16 | 2 | 奖励的金币                         |
| reward_exp    | uint16 | 2 | 奖励的经验值                       |
| reward_happy  | uint16 | 2 | 奖励的愉悦值                       |
| extra_coins   | uint16 | 2 | 额外的金币奖励（打破最高分会获得） |
| current_happy | uint32 | 4 | 当前的愉悦度                             |

*** 错误码
  | 100812：答对的数量大于总共答题的数量   |
  | 100810, 获得缓存里的用户角色信息失败   |
  | 100007：未知的系统错误(转换时间戳出错) |
  | 100815：当天已经玩过的每日挑战         |
  | 100816：不存在的益智游戏类型           |
  | 100826：不满足益智游戏所yaoqi          |
  |                                        |

** 拉取好友列表: 40111
*** 请求包
| 名称     | 类型   | 字节数 | 说明                      |
|----------+--------+--------+---------------------------|
| page     | uint8  |      1 | 好友页数                  |
| page_num | uint8  |      1 | 每页好友的数量(上限100个) |
| user_id  | uint32 |      4 | 要拉取的用户的米米号                |

*** 应答包
| 名称            | 类型     | 字节数 | 说明                       |
|-----------------+----------+--------+----------------------------|
| total_num       | uint16   |      2 | 总的好友数量               |
| count           | uint8    |      1 | 实际拉取到的好友数量       |
| ...             |          |        |                            |
| user_id         | uint32   |      4 | 米米号                     |
| name            | char(16) |     16 | 用户名字                   |
| gender          | uint8    |      1 | 用户性别(0:女 1：男)       |
| country_id      | uint32   |      4 | 国籍                       |
| birthday        | uint32   |      4 | 生日(格式: 20111108)       |
| user_type       | uint8    |      1 | 0:普通用户 1：vip用户      |
| mon_id          | uint32   |      4 | 怪兽id                     |
| mon_level       | uint16   |      2 | 怪兽等级                   |
| mon_main_color  | uint32   |      4 | 怪兽主颜色                 |
| mon_ex_color    | uint32   |      4 | 怪兽辅颜色                 |
| mon_eye_color   | uint32   |      4 | 怪兽眼睛颜色                     |
| last_login_time | uin32    |      4 | 用户上次登录时间           |
| is_bestfriend   | uint8    |      1 | 是否最爱好友(0:不是 1：是) |

*** 错误码
| 100839：操作好友列表缓存信息失败 |
|                                  |

** 拉取单个好友信息; 40112
*** 请求包
| 名称    | 类型 | 字节数 | 说明 |
|---------+------+--------+------|
| user_id | uint32 |   4    | 好友米米号 |
 
*** 应答包
同40102

*** 错误码
| 100810, 获得缓存里的用户角色信息失败 |
|                                      |

** 好友操作: 40113
*** 请求包
| 名称    | 类型   | 字节数 | 说明       |
|---------+--------+--------+------------|
| user_id | uint32 |      4 | 好友米米号 |
| op_type | uint8  |      1 | 操作类型(0:设为最爱, 1:取消最爱,2:删除好友,3:屏蔽好友) |

*** 应答包
| 名称    | 类型  | 字节数 | 说明 |
|---------+-------+--------+------|
| op_type | uint8 | 1      | 操作类型 | 

*** 错误码
| 100819：非法的的好友操作类型 |
|                              |

** 查找好友: 40114  
*** 请求包
| 名称        | 类型     | 字节数 | 说明 |
|-------------+----------+--------+------|
| search_user | char(16) | 16     | 要查找用户的名字或米米号的字符串     |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                 |
|----------------+----------+--------+----------------------|
| count          | uint8    |      1 | 查找到的好友数量     |
| ...            |          |        |                      |
| user_id        | uint32   |      4 | 米米号               |
| name           | char(16) |     16 | 用户名字             |
| gender         | uint8    |      1 | 0:女  1:男           |
| country_id     | uint32   |      4 | 国籍                 |
| birthday       | uint32   |      4 | 生日(格式: 20111204) |
| user_type      | uint8    |      1 | 用户类型(0:普通用户) |
| mon_id         | uint32   |      4 | 怪兽id               |
| mon_main_color | uint32   |      4 | 怪兽主颜色           |
| mon_ex_color   | uint32   |      4 | 怪兽辅颜色           |
| mon_eye_color  | uint32   |      4 | 怪兽眼睛颜色               |

** 添加好友: 40115
*** 请求包
| 名称       | 类型     | 字节数 | 说明           |
|------------+----------+--------+----------------|
| user_id    | uint32   |      4 | 好友米米号     |
| remark_num | uint8    |      1 | remark的字符数 |
| remark     | char(16) | 不定长    | 好友申请时的留言(不超过256字节) |

*** 应答包
空

*** 错误码
  | 100834：重复申请好友（需要前端单独处理） |
  |                                          |
  | 100844:不能把自己加为好友                |
  | 100848:已经时好友                             |

** 拉取好友申请: 40116
*** 请求包
空

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|
| flag           | uint8    |      1 | 是否还有好友申请(0:没有 1：有) |
| count          | uint8    |      1 | 好友申请的数量(最多99个)       |
| ...            |          |        |                                |
| user_id        | uint32   |      4 | 米米号                         |
| name           | char(16) |     16 | 用户名字                       |
| gender         | uint8    |      1 | 0:女  1:男                     |
| country_id     | uint32   |      4 | 国籍                           |
| birthday       | uint32   |      4 | 生日(格式: 20111204)           |
| user_type      | uint8    |      1 | 用户类型(0:普通用户)           |
| mon_id         | uint32   |      4 | 怪兽id                         |
| mon_main_color | uint32   |      4 | 怪兽主颜色                     |
| mon_ex_color   | uint32   |      4 | 怪兽辅颜色                     |
| mon_eye_color  | uint32   |      4 | 怪兽眼睛颜色                   |
                                                                                                                                         |

*** 错误码
| 100842：缓存好友申请信息失败 |
|                              |

** 对好友申请的操作: 40117
*** 请求包
| 名称    | 类型   | 字节数 | 说明       |
|---------+--------+--------+------------|
| peer_id | uint32 |      4 | 对方米米号 |
| type    | uint8  |      1 | 0:同意 1：忽略 2：屏蔽 |

*** 应答包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| peer_id | uint32 | 4      | 对方米米号 |

*** 错误码

** 拉取用户的留言板信息:40118
*** 请求包
| 名称     | 类型   | 字节数 | 说明                 |
|----------+--------+--------+----------------------|
| user_id  | uint32 |      4 | 要拉取的用户的米米号 |
| page     | uint32 |      4 | 留言板页数           |
| page_num | uint8  |      1 | 每页留言的数量(最多8个)        | 
  
*** 应答包
| 名称           | 类型     | 字节数 | 说明                         |
|----------------+----------+--------+------------------------------|
| count          | uint8    |      1 | 实际拉取到的留言数量         |
| ...            |          |        |                              |
| id             | uint32   |      4 | 留言 id                      |
| icon           | uint8    |      1 | 便签的图案编号               |
| color          | uint8    |      1 | 便签的颜色                   |
| user_id        | uitn32   |      4 | 写留言的用户的米米号         |
| name           | char(16) |     16 | 用户名字                     |
| user_type      | uint8    |      1 | 0:普通用户 1： vip           |
| mon_id         | uint32   |      4 | 怪兽id                       |
| mon_level      | uint16   |      2 | 怪兽等级                     |
| mon_main_color | uint32   |      4 | 怪兽主颜色                   |
| mon_ex_color   | uint32   |      4 | 怪兽辅颜色                   |
| mon_eye_color  | uint32   |      4 | 怪兽眼睛颜色                 |
| create_time    | uint32   |      4 | 留言创建的时间               |
| status         | uint8    |      1 | 留言状态(1:未审核 2：已审核) |
| message_count  | uint16   |      2 | 留言的字节数                 |
| message        | char()   |        | 留言的内容                        |

*** 错误码
    | 100823：不能拉取第0页的留言         |
    | 100840:留言板一页的留言数超过最大值 |
    | 100841:缓存留言板信息失败           |
    |                                     |

** 新增一条留言:40119
*** 请求包
| 名称    | 类型   | 字节数 | 说明               |
|---------+--------+--------+--------------------|
| peer_id | uint32 |      4 | 被留言的用户米米号 |
| icon    | uint8  |      1 | 便签的图片编号     |
| color   | uint8  |      1 | 便签的颜色编号     |
| message | char() |        | 留言内容 ，最多512字节      |

*** 应答包
| 名称           | 类型     | 字节数 | 说明           |
|----------------+----------+--------+----------------|
| id             | uint32   |      4 | 留言的id       |
| name           | char(16) |     16 | 用户名字       |
| mon_id         | uint32   |      4 | 怪兽id         |
| mon_level      | uit16    |      2 | 怪兽等级       |
| mon_main_color | uint32   |      4 | 怪兽的主颜色   |
| mon_ex_color   | uint32   |      4 | 怪兽的辅颜色   |
| mon_eye_color  | uint32   |      4 | 怪兽眼睛的颜色 |
| create_time    | uint32   |      4 | 留言的创建时间        |

*** 错误码
  | 100824：留言不能为空                 |
  | 100810：获得缓存里的用户角色信息失败 |
  |                                      |


** 对留言的操作:40120
*** 请求包
| 名称    | 类型   | 字节数 | 说明                                                 |
|---------+--------+--------+------------------------------------------------------|
| user_id | uint32 |      4 | 被操作留言的用户的米米号(0:表示对自己的留言进行操作) |
| id      | uint32 |      4 | 留言的id                                             |
| type    | uint8  |      1 | 0：删除一条留言 1：审核未通过 2：审核通过4：举报留言                        |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码
| 100817：不存在的操作类型                       |
| 100818：不是自己的留言，不能进行除举报外的操作 |
|                                                |

** 顶用户的小屋:40121
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| peer_id | uint32 | 4      | 被顶的笑我用户的米米号 |

*** 应答包
| 名称 | 类型  | 字节数 | 说明 |
|------+-------+--------+------|
| flag | uint8 | 1      | 0:已经顶过用户的小屋 1:陈宫顶用户的小屋 |

*** 错误码
     | 100601：给唯一数服务发送请求失败          |
     | 100822:重复顶用户的小屋(需要前端单独处理) |
     |                                           |

** 拉取种植园信息:40122
*** 请求包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 应答包
| 名称                      | 类型   | 字节数 | 说明                                                                  |
|---------------------------+--------+--------+-----------------------------------------------------------------------|
| hole_count                | uint8  |      1 | 坑的个数(目前固定为3)                                                 |
| ....                      |        |        |                                                                       |
| plant_id                  | uint32 |      4 | 植物id(没有植物时取值0)                                               |
| hole_id                   | uint8  |      1 | 坑的编号(1,2,3)                                                       |
| color                     | uint16 |      2 | 颜色编号                                                              |
| last_growth               | uint16 |      2 | 上次进种植园的成长值                                                  |
| growth                    | uint16 |      2 | 成长值                                                                |
| maintain                  | uint8  |      1 | 维护选项(0:不需要维护 1：浇水 2：修剪 3：施肥 4：收获)                |
| reward_num                | uint32 |      4 | 未领取的阳光奖励包个数(最大500个，超过500后需要等领取完后重新进入种植园)                   |
| ...                       |        |        |                                                                       |
| reward_id                 | uint32 |      4 | 奖励包id                                                                 |

| 下面的内容不属于hole_count循环 |        |        |                                                                       |
| flag                      | uint8  |      1 | 1:能吸引到小怪兽 2:种子没有3个或没有都成熟不能吸引到 3:颜色没有匹配到 |
| flag为1返回以下字段       |        |        |                                                                       |
| pet_id                    | uint32 |      4 | 小怪兽id                                                              |
| flag为3返回以下字段       |        |        |                                                                       |
| hole_1                    | uint8  |      1 | 第一个坑的颜色是否匹配                                                |
| hole_2                    | uint8  |      1 | 第二个坑的颜色是否匹配                                                |
| hoel_3                    | uint8  |      1 | 第三个坑的颜色是否匹配                                                |

*** 错误码
   | 100810：获得缓存里的用户角色信息失败         |
   | 100843：吸引到小怪兽，但是种植园植物没有种满 |
   |                                              |

** 种植园种植物:40123
*** 请求包
| 名称     | 类型   | 字节数 | 说明 |
|----------+--------+--------+------|
| plant_id | uint32 | 4      | 植物id |
| hole_id  | uint8  | 1      | 坑的编号   | 
  
*** 应答包
| 名称     | 类型  | 字节数 | 说明   |
|----------+-------+--------+--------|
| hole_id  | uint8 |      1 | 坑编号 |
| maintain | uint8 |      1 | 维护选项(0:没有维护操作 1：浇水 2：音乐 3：施肥  )          |

*** 错误码
  | 100828：坑上已种过植物，不能重复种 |
  | 100835：没有足够的种子种植         |
  | 100806：缓存里找不到用户的背包信息 |
  |                                    |


** 种植园维护植物:40124
*** 请求包
| 名称     | 类型  | 字节数 | 说明     |
|----------+-------+--------+----------|
| hole_id  | uint8 |      1 | 坑的编号 |
| maintain | uint8 |      1 | 维护选项(0:没有维护操作 1:浇水 2：音乐 3：施肥 4：收获 5：铲除) |
  
*** 应答包
| 名称                   | 类型   | 字节数 | 说明                                                       |
|------------------------+--------+--------+------------------------------------------------------------|
| hole_id                | uint8  |      1 | 坑的编号                                                   |
| reward_id              | uint32 |      4 | 阳光奖励包id(没有阳关奖励时为0)                                    |
| reward_coins           | uint16 |      2 | 奖励的咕咚果                                               |
| reward_growth          | uint16 |      2 | 增加的成长值                                               |
| maintain               | uint8  |      1 | 下一个维护选项(0:不需要维护 1：浇水 2:修剪 3：施肥 4:收获) |
| flag                   | uint8  |      1 | 1:能吸引到小精灵 2:种子没有3个或没有全部成熟 3：颜色不匹配 |
| flag = 1时返回下面字段 |        |        |                                                            |
| pet_id                 | uint32 |      4 | 吸引到的小精灵id                                           |
| flag = 3时返回下面字段 |        |        |                                                            |
| hole1                  | uint8  |      1 | 第一个坑的颜色是否匹配                                     |
| hole2                  | uint8  |      1 | 第二个坑的颜色是否匹配                                     |
| hole3                  | uint8  |      1 | 第三个坑的颜色是否匹配                                                |

*** 错误码
| 100829：坑上没有种植物   |
| 100865: 错误的坑编号    |
| 100866: 错误的维护类型 |


** 对吸引到的小怪收的操作:40125
*** 请求包
| 名称   | 类型   | 字节数 | 说明                                      |
|--------+--------+--------+-------------------------------------------|
| type   | uint8  |      1 | 1:领养 2：放生 3:删除(针对已经收养的精灵) |
| pet_id | uint32 |      4 | 要操作的精灵id                                  |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码
| 错误码                                         |
|------------------------------------------------|
| 100831：没有定义的对吸引到小怪兽的操作         |
| 100830：没有吸引到小怪兽，不能进行小怪兽的操作 |
| 100869:传过来的精灵id与服务器记录的不一致                      |
| 100870:已经拥有3个精灵，必须删除一个才可以继续收养

** 获得商业街上的用户信息: 40126
*** 请求包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 应答包
| 名称             | 类型     | 字节数 | 说明                             |   |
|------------------+----------+--------+----------------------------------+---|
| count            | uint8    |      1 | 获得的用户数量                   |   |
| ...              |          |        |                                  |   |
| user_id          | uint32   |      4 | 用户的id                         |   |
| name             | char(16) |     16 | 用户昵称                         |   |
| gender           | uint8    |      1 | 用户性别(0:女性 1：男性)         |   |
| country_id       | uint32   |      4 | 国籍id                           |   |
| user_type        | uint8    |      1 | (0:普通用户 1：vip用户 2:gm用户) |   |
| birthday         | uint32   |      4 | 生日，格式(20110723)             |   |
| mon_id           | uint32   |      4 | 怪兽id                           |   |
| mon_name         | char(16) |     16 | 怪兽昵称                         |   |
| mon_main_color   | uint32   |      4 | 怪兽主颜色                       |   |
| mon_exp_color    | uint32   |      4 | 怪兽辅颜色                       |   |
| mon_eye_color    | uint32   |      4 | 怪兽眼睛颜色                     |   |
| mon_exp          | uint32   |      4 | 怪兽经验值                       |   |
| mon_level        | uint16   |      2 | 怪兽等级                         |   |
| mon_health       | uint32   |      4 | 怪兽健康值                       |   |
| mon_happy        | uint32   |      4 | 怪兽愉悦度                       |   |
| friend_num       | uint16   |      2 | 好友总数                         |   |
| visits           | uint32   |      4 | 小屋的访问次数                   |   |
| mood             | uint8    |      1 | 用户心情                         |   |
| fav_color        | uint8    |      1 | 用户最爱的颜色                   |   |
| fav_pet          | uint8    |      1 | 用户最爱的精灵                   |   |
| fav_fruit        | uint8    |      1 | 用户最爱的水果                   |   |
| room_num         | uint8    |      1 | 用户房间数量                     |   |
| pet_num          | uint8    |      1 | 用户精灵个数                     |   |
| max_puzzle_score | uint16   |      2 | 益智游戏最高分                   |   |
| pet_id           | uint32   |      4 | 跟随精灵的id,0表示没有跟随精灵   |   |
| count            | uint8    |      1 | 个性签名的字节数                 |   |
| personal_sign    | char()   |        | 个性签名                             |   |

*** 错误码

** 提交小游戏答题结果: 40127
*** 请求包
| 名称         | 类型   | 字节数 | 说明         |
|--------------+--------+--------+--------------|
| game_id      | uint32 |      4 | 游戏id       |
| level_id     | uint32 |      4 | 关卡id         |
| gained_coins | uint32 |      4 | 获得的金币数 |
| score        | uint32 |      4 | 得分         |

*** 应答包
| 名称                         | 类型   | 字节数 | 说明                                                      |   |   |   |   |   |   |   |   |   |   |   |
|------------------------------+--------+--------+-----------------------------------------------------------+---+---+---+---+---+---+---+---+---+---+---|
| game_id                      | uint32 |      4 | 游戏id                                                    |   |   |   |   |   |   |   |   |   |   |   |
| level_id                     | uint32 |      4 | 关卡id                                                    |   |   |   |   |   |   |   |   |   |   |   |
| is_restrict                  | uint8  |      1 | 0:未达到每日上限 1：达到每日上限                                        |   |   |   |   |   |   |   |   |   |   |   |
| reward_coins                 | uint32 |      4 | 实际可以得到的金币                                        |   |   |   |   |   |   |   |   |   |   |   |
| star_num                     | uint8  |      1 | 获得的星星数                                              |   |   |   |   |   |   |   |   |   |   |   |
| next_level_lock              | uint8  |      1 | 下一关是否解锁(0:未解锁 1：解锁 2：没有下一关了)          |   |   |   |   |   |   |   |   |   |   |   |
| reason                       | uint8  |      1 | 0:正常 1：分数不够 2：达到每日限制                        |   |   |   |   |   |   |   |   |   |   |   |
| reason=0时才有下面的两个字段 |        |        |                                                           |   |   |   |   |   |   |   |   |   |   |   |
| stuff_num                    | uint8  |      1 | 获得该道具的数量                                          |   |   |   |   |   |   |   |   |   |   |   |
| stuff_id                     | uint32 |      4 | 获得的道具id(这里只是获得一种道具,但这种道具可以获得多个) |   |   |   |   |   |   |   |   |   |   |   |
|                              |        |        |                                                           |   |   |   |   |   |   |   |   |   |   |   |

*** 错误码

** 怪兽吃食物: 40128
*** 请求包
| 名称    | 类型   | 字节数 | 说明         |
|---------+--------+--------+--------------|
| item_id | uint32 |      4 | 食物的物品id |

*** 应答包

*** 错误码

** 更改用户的profile信息: 40129
*** 请求包
| 名称                         | 类型   | 字节数     | 说明                                                                             |
|------------------------------+--------+------------+----------------------------------------------------------------------------------|
| type                         | uint8  | 1          | 要更改的信息的类型(1:个性签名,2:今天心情,3:最爱的颜色,4:最爱的精灵,5:最爱的食物) |
| 下面的字段根据type的类型确定 |        |            |                                                                                  |
| type:1                       |        |            |                                                                                  |
| personal-sign                | char() | 最大64字节 | 个性签名                                                                         |
| type: 2, 3, 4,5              |        |            |                                                                                  |
| id                           | uint32 | 4          | 选择的物品的id                                                                                  |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码

** 拉取商店的物品列表: 40130
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| shop_id | uint32 | 4      | 商店id |

*** 应答包
| 名称        | 类型   | 字节数 | 说明     |
|-------------+--------+--------+----------|
| remain_time | uint16 |      2 | 剩余刷新时间   |
| count       | uint16 |      2 | 物品个数 |
| ...         |        |        |          |
| item_id     | uint32 |      4 | 物品id   |
|             |        |        |          |
*** 错误码

** 更新新手引导的flag标识: 40131
*** 请求包
| 名称 | 类型    | 字节数 | 说明 |
|------+---------+--------+------|
| flag | uint32  |  4     | 标识位  |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码

** 二手物品的兑换: 40132
*** 请求包
| 名称     | 类型   | 字节数 | 说明                     |
|----------+--------+--------+--------------------------|
| stuff_id | uint32 |      4 | 要兑换的物品             |
| req_type | uint8  |      1 | 1: 固定的40%  2:随机抽奖 |

*** 应答包
| 名称    | 类型   | 字节数 | 说明                   |
|---------+--------+--------+------------------------|
| percent | uint8  |      1 | 取值 1-10              |
| coins   | uint32 |      4 | 该物品可以换到多少金币 |

** as向online获取精灵园的所有精灵: 40133
*** 请求包
| 名称    | 类型 | 字节数 | 说明 |
|---------+------+--------+------|
| user_id | uint32  |  4     | 被查看的用户的米米号 |

*** 应答包
| 名称        | 类型   | 字节数 | 说明             |
|-------------+--------+--------+------------------|
| pet_num     | uint16 |      2 | 精灵的数量       |
| ...         |        |        |                  |
| pet_id      | uint32 |      4 | 精灵ID           |
| pet_total   | uint16 |      2 | 该精灵的拥有数量 |
| pet_in_home | uint16 |      2 | 该精灵在家中的数量        |


** 进入二人益智游戏比赛: 40134
*** 请求包
空
*** 应答包
| 名称                         | 类型     | 字节数 | 说明                                             |   |
|------------------------------+----------+--------+--------------------------------------------------+---|
| is_found                     | uint8    |      1 | 0:未找到对手，需要等待，进入等待页面 1：找到对手 |   |
| is_found=1时才会有下面的字段 |          |        |                                                  |   |
| opponent_id                  | uint32   |      4 | 对方米米号                                       |   |
| opponent_name                | char(16) |     16 | 对方名称                                         |   |
| is_vip                       | uint8    |      1 | 是否VIP用户(0:普通用户 1：VIP用户 2:GA用户)      |   |
| mon_id                       | uint32   |      4 | 怪兽id                                           |   |
| mon_main_color               | uint32   |      4 | 怪兽主颜色                                       |   |
| mon_exp_color                | uint32   |      4 | 怪兽辅颜色                                       |   |
| mon_eye_color                | uint32   |      4 | 怪兽眼睛颜色                                     |   |
| initial_total_time           | uint16   |      2 | 比赛初始总时间 单位秒                                        |   |
| quest_num                    | uint16   |      2 | 题目数量                                         |   |
| ....                         |          |        |                                                  |   |
| quest_type                   | uint8    |      1 | 题目类型                                         |   |
| quest_id                     | uint32   |      4 | 题目id                                           |   |
|                              |          |        |                                                  |   |
*** 错误码
| 100301  | 已经在多人益智游戏中，重复进入 |



** 二人益智游戏，online给as推送匹配信息: 42003
| 名称                         | 类型     | 字节数 | 说明                                         |
|------------------------------+----------+--------+----------------------------------------------|
| is_found                     | uint8    |      1 | 0:未找到对手 1：找到对手                     |
| is_found=1时菜会有下面的字段 |          |        |                                              |
| opponent_id                  | uint32   |      4 | 对手米米号                                   |
| opponent_name                | char(16) |     16 | 对手名称                                     |
| is_vip                       | uint8    |      1 | 是否VIP用户(0:普通用户 1：VIP用户 2：GA用户) |
| mon_id                       | uint32   |      4 | 怪兽id                                       |
| mon_main_color               | uint32   |      4 | 怪兽主颜色                                   |
| mon_exp_color                | uint32   |      4 | 怪兽辅颜色                                   |
| mon_eye_color                | uint32   |      4 | 怪兽眼睛颜色                                 |
| initial_total_time           | uint16   |      2 | 比赛初始总时间,单位秒                                  |
| question_num                 | uint16   |      2 | 题目数量(未找到对手时，题目数量为0)          |
| ...                          |          |        |                                              |
| quest_type                   | uint8    |      1 | 题目类型                                     |
| quest_id                     | uint32   |      4 | 题目id                                       |

** 二人益智游戏比赛匹配成功，点击start按钮: 40135
*** 请求包
空
*** 应答包
| 名称               | 类型     | 字节数 | 说明                                            |
|--------------------+----------+--------+-------------------------------------------------|
| status             | uint8    |      1 | 0: 对方已离开 1:对方未开始，需等待 2:对方已开始，直接进入游戏            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

** 二人益智游戏,online给as推送进入游戏信息：42004
| 名称   | 类型  | 字节数 | 说明 |
|--------+-------+--------+------|
| status | uint8 | 1      | 0:用户自己长时间未点击start按钮 1：对手长时间未点击start按钮  2：进入游戏 |

** 答题： 40136
*** 请求包
| 名称        | 类型   | 字节数 | 说明                           |
|-------------+--------+--------+--------------------------------|
| result      | uint8  |      1 | 0:答题正确 1：答题错误         |
| is_end      | uint8  |      1 | 答题是否结束(0:未结束 1：结束) |
| remain_time | uint16 |      2 | 剩余时间（当结束时剩余时间为0）               |

*** 应答包
| 名称                       | 类型   | 字节数 | 说明                                                                                  |
|----------------------------+--------+--------+---------------------------------------------------------------------------------------|
| status                     | uint8  |      1 | 是否结束(1:用户自己未结束 2：用户自己已结束， 但对方未结束 3、用户自己和对手豆已结束) |
| status = 3时才有下面的字段 |        |        |                                                                                       |
| score                      | uint16 |      2 | 自己得分                                                                              |
| opp_sscore                 | uint16 |      2 | 对手得分                                                                              |
| result                     | uint8  |      1 | 0:平局 1：胜利 2：失败h                                                               |
| reward_coins               | uint16 |      2 | 奖励的咕咚果                                                                          |
| is_restrict                | uint8  |      1 | 是否达到每日上限(0;么有 1;有)(与multi-server通信时无该字段)                                              |

** 二人益智游戏，online给as推送对手的答题信息:42005
| 名称            | 类型   | 字节数 | 说明                |
|-----------------+--------+--------+---------------------|
| opp_score       | uint16 |      2 | 对手当前得分        |
| opp_remain_time | uint16 |      2 | 对手剩余时间,单位秒 |
| opp_is_end      | uint8  |      1 | 对手是否已结束(0:未结束 1：已结束) |

** 二人益智游戏，online给as推送的比赛结果信息: 42006
| 名称         | 类型   | 字节数 | 说明                   |
|--------------+--------+--------+------------------------|
| score        | uint16 |      2 | 自己得分               |
| opp_score    | uint16 |      2 | 对手得分               |
| result       | uint8  |      1 | 0:平局 1：胜利 2：失败 |
| reward_coins | uint16 |      2 | 奖励的咕咚果           |
| is_restrict  | uint8  |      1 | 是否达到每日上限(0:没有 1：有)(与multi-svr通信无该字段) |


** 互动元素奖励:40137
*** 请求包
| 名称           | 类型   | 字节数 | 说明 |
|----------------+--------+--------+------|
| interactive_id | uint32 |      4 |  互动元素编号(从1001开始)    |

*** 应答包
| 名称             | 类型   | 字节数 | 说明                           |
|------------------+--------+--------+--------------------------------|
| is_restrict      | uint8  |      1 | 是否达到每日上限(0:没有 1：有) |
| rewards_coins    | uint16 |      2 | 奖励的咕咚果数量               |
| 端午节活动返回包 |        |        |                                |
| is_reward        | uint8  |      1 | 能否奖励叶子0：能 1：不能      |

** AS发过来的统计信息: 40138
*** 请求包
| 名称  | 类型   | 字节数 | 说明         |
|-------+--------+--------+--------------|
| type  | uint8  |      1 | 用户操作类型(1:离开商店 2：开始小游戏 3：访问麦咭) |
| value | uint32 |      4 | 类型值(没有值时填0)  |

*** 没有应答包 

** 打开最近来访面板：40139
*** 请求包
空
*** 应答包
| 名称                 | 类型     | 字节数 | 说明                               |
|----------------------+----------+--------+------------------------------------|
| visit_num            | uint16   |      2 | 来访者数量(最多99个)               |
| ...                  | ...      |    ... | ...                                |
| status               | uint8    |      1 | 状态(0:未读 1：已读)                      |
| visit_type           | uint8    |      1 | 来访类型(1:访问 2：顶)             |
| visit_time           | uint32   |      4 | 来访时间戳                         |
| visit_id             | uint32   |      4 | 来访者米米号                       |
| is_vip               | uint8    |      1 | 是否vip用户(0:普通用户 1：VIP用户) |
| visit_name           | char(16) |     16 | 来访者名字                         |
| visit_mon_id         | uint32   |      4 | 来访者怪兽id                       |
| visit_mon_main_color | uint32   |      4 | 怪兽颜色                           |
| visit_mon_exp_color  | uint32   |      4 | 怪兽颜色                           |
| visit_mon_eye_color  | uint32   |      4 | 怪兽颜色                           |

** 打开成就面板: 40140
*** 请求包
| peer_id | uint32 | 4 | 被查看的用户的米米号|

*** 应答包
| 名称           | 类型   | 字节数 | 说明                                     |
|----------------+--------+--------+------------------------------------------|
| badge_num      | uint16 |      2 | 成就项个数                               |
| ...            | ...    |    ... | ...                                      |
| badge_id       | uint32 |      4 | 成就项id                                 |
| badge_status   | uint8  |      1 | 成就项状态(0:进行中 1：已获得未领奖杯 2:已获得未查看 3：已获得已领奖) |
| badge_progress | uint32 |      4 | 成就项进度                                    |

** 领取成就项奖杯: 40141
*** 请求包
| 名称     | 类型   | 字节数 | 说明 |
|----------+--------+--------+------|
| badge_id | uint32 | 4      | 要领取的成就项id |

*** 应答包
| 名称      | 类型   | 字节数 | 说明 |
|-----------+--------+--------+------|
| reward_id | uint32 | 4      | 奖杯id |

** online通知客户端有新的成就项获得:42008
| 名称             | 类型   | 字节数 | 说明 |
|------------------+--------+--------+------|
| unread_badge_num | uint16 | 2      | 未查看的成就项个数 |

** 拉取实际可以看到的留言条数: 40142
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| peer_id | uint32 | 4      | 被查看的用户的米米号 |
*** 应答包
| 名称     | 类型   | 字节数 | 说明 |
|----------+--------+--------+------|
| real_num | uint32 | 4      | 实际可以看到的留言条数 |

** 拉取最近访客未读条数:40143
*** 请求包
空
*** 应答包
| 名称       | 类型   | 字节数 | 说明 |
|------------+--------+--------+------|
| unread_num | uint16 | 2      | 未读数量 |

** online有新的实时通知: 42000
*** 请求包
| 名称 | 类型  | 字节数 | 说明 |
|------+-------+--------+------|
| type | uint8 | 1      | 1:有好友请求 2:有新的留言 5:有新的访客 |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码

** online广播包 ，定时清理关掉的连接: 42001
*** 请求包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码

** 实时通知as更新用户的用户信息: 42002
*** 请求包
| 名称       | 类型   | 字节数 | 说明               |
|------------+--------+--------+--------------------|
| mon_happy  | uint32 |      4 | 怪兽愉悦度         |
| mon_health | uint32 |      4 | 怪兽健康值         |
| mon_exp    | uint32 |      4 | 怪兽经验           |
| mon_level  | uint16 |      2 | 怪兽等级           |
| coins      | uint32 |      4 | 用户金币           |
| visits     | uint32 |      4 | 用户小屋的访问次数 |
| thumb      | uint32 |      4 | 小屋被顶的次数            |

*** 应答包
| 名称           | 类型     | 字节数 | 说明                           |
|----------------+----------+--------+--------------------------------|

*** 错误码

** 拉取小游戏的关卡信息(只拉取已经解锁的关卡): 40144
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| game_id | uint32 | 4      | 游戏id |

*** 应答包
| 名称            | 类型   | 字节数 | 说明         |
|-----------------+--------+--------+--------------|
| next_level_lock | uint8  |      1 | 下一关是否解锁(0:未解锁 1：解锁 2：么有下一关了) |
| level_num       | uint16 |      2 | 关卡数量     |
| ......          |        |        |              |
| level_id        | uint32 |      4 | 关卡id       |
| max_score       | uint32 |      4 | 曾经的最高分 |
| acquired_star   | uint8  |      1 | 获得的星星数 |

** 拉取合成工厂信息:40145
*** 请求包
空
*** 应答包
| 名称         | 类型   | 字节数 | 说明                                                                     |
|--------------+--------+--------+--------------------------------------------------------------------------|
| status       | uint8  |      1 | 0:合成工厂空闲 1:合成工厂有物品合成，2:合成工厂已合成出物品              |
| time_or_item | uint32 |      4 | status=0没有该字段 status=1时为合成物品的剩余时间 status=2为合成的物品id |
| map_id       | uint32 |      4 | 图纸id（status=1时才有该字段）                                                     |
|              |        |        |                                                                          |
** 提交合成信息: 40146
*** 请求包
| 名称 | 类型   | 字节数 | 说明 |
|------+--------+--------+------|
| id   | uint32 | 4      | 合成图纸id |
*** 应答包
| 名称      | 类型   | 字节数 | 说明 |
|-----------+--------+--------+------|
| left_time | uint32 |      4 | 合成剩余时间 |

** 合成工厂操作:40147
*** 请求包
| 名称   | 类型  | 字节数 | 说明 |
|--------+-------+--------+------|
| status | uint8 | 1      | 1:领取合成物品，2:取消合成物品     |

***  应答包
空

** 检测名字是否脏词: 40148
*** 请求包
| 名称 | 类型     | 字节数 | 说明 |
|------+----------+--------+------|
| name | char(16) | 16     | 需要检测的名字 |

*** 应答包
| 名称  | 类型  | 字节数 | 说明 |
|-------+-------+--------+------|
| dirty | uint8 | 1      | 是否脏词(0:不是  1：是) |

** 修改怪兽名字:40149
*** 请求包
| 名称 | 类型     | 字节数 | 说明 |
|------+----------+--------+------|
| mon_name | char(16) | 16     | 新的怪兽名字 |

*** 应答包
空

** as随机获取一个名字给用户: 40151
*** 请求包
| gender | uint8 | 1 | 性别(0:女性 1：男性)

*** 应答包
| name | char(16) | 16 | 随机到的用户名字|

** 领取卜卜报奖励:40152
*** 请求包 

*** 应答包
| 名称         | 类型   | 字节数 | 说明 |
|--------------+--------+--------+------|
| reward_coins | uint16 |      2 | 奖励的金币数 |

** 领取种植园阳关奖励包:40153
*** 请求包
| 名称      | 类型   | 字节数 | 说明         |
|-----------+--------+--------+--------------|
| hole_id   | uint8  |      1 | 坑的编号         |
| reward_id | uint32 |      4 | 阳关奖励包id |

*** 应答包
| 名称         | 类型   | 字节数 | 说明                               |
|--------------+--------+--------+------------------------------------|
| hole_id      | uint8  |      1 | 坑的编号                           |
| reward_id    | uint32 |      4 | 阳关奖励包id                            |
| reward_happy | uint16 |      2 | 奖励的快乐值(为0表示不奖励该项)    |
| reward_exp   | uint16 |      2 | 奖励的经验值（为0表示不奖励该项）  |
| reward_coins | uint16 |      2 | 奖励的咕咚果 （为0表示不奖励该项） |

** 读卜卜报: 40154
*** 请求包

*** 应答包

** 进入大众点评: 40155
*** 请求包
空

*** 应答包
| 名称        | 类型   | 字节数 | 说明                             |
|-------------+--------+--------+----------------------------------|
| status      | uint8  |      1 | 1:今天未点评过 2：今天已经点评过 |
| total_score | uint32 |      4 | 最终得分                         |
| npc_num     | uint8  |      1 | 参与点评的NPC的个数(目前为3个)   |
| ....        |        |        |                                  |
| npc_id      | uint32 |      4 | npc_id                           |
| npc_score   | uint32 |      4 | npc给出的分数                         |

** NPC评分:40156
*** 请求包
空

*** 应答包
| 名称        | 类型   | 字节数 | 说明      |
|-------------+--------+--------+-----------|
| total_score | uint32 |      4 | 最终得分  |
| npc_num     | uint8  |      1 | npc的个数 |
| ...         | ..     |        |           |
| npc_id      | uint32 |      4 | npc_id    |
| npc_score   | uint32 |      4 | npc给出的分数  |
  
*** 错误码
100871 ：今天已经评过了

** 拉取游戏当前期奖励兑换信息:40157
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| game_id | uint32 | 4      | 游戏id(当前只有蛋糕店游戏) |
|         |        |        |      |
*** 应答包
| 名称       | 类型   | 字节数 | 说明                     |
|------------+--------+--------+--------------------------|
| game_id    | uint32 |      4 | 游戏id                   |
| stuff_num  | uint16 |      2 | 本期已经兑换到的物品个数 |
| ...        |        |        |                          |
| stuff_id   | uint32 |      4 | 物品道具id               |


** 小游戏兑换物品:40158
*** 请求包
| game_id    | uint32 | 4 | 游戏id｜       |
| stuff_id   | uint32 | 4 | 要兑换的物品id |
| game_score | uint32 | 4 | 得分(为了统计) |
| level_num  | uint16 | 2 | 关卡(为了成就项)      |

*** 应答包
空

*** 错误码
100873 :已经兑换过



** 拉取已完成任务列表: 40159
*** 请求包
空
*** 应答包
| 名称              | 类型   | 字节数 | 说明           |
|-------------------+--------+--------+----------------|
| finished_task_num | uint16 | 2      | 已完成任务个数 |
| ...               | ...    | ...    | ...            |
| task_id           | uint32 | 4      | 任务id           |

** 完成一个任务: 40160
*** 请求包
| 名称    | 类型   | 字节数 | 说明 |
|---------+--------+--------+------|
| task_id | uint32 | 4      | 任务id |
*** 应答包
| 名称            | 类型   | 字节数 | 说明                                                                      |
|-----------------+--------+--------+---------------------------------------------------------------------------|
| task_id         | uint32 |      4 | 任务id                                                                    |
| reward_type_num | uint8  |      1 | 奖励的种类数量                                                            |
| ...             | ....   |   .... | .....                                                                     |
| reward_id       | uint32 |      4 | 奖励的物品(10000001:为奖励的金币 其他暂时为奖励的道具 )           |
| reward_num      | uint16 |      2 | 奖励的数量                                                                |
*** 错误码
100874 任务等级条件未达到
100875 任务前置任务未完成

** 进入援助计划面板: 40161
*** 请求包
空
*** 应答包
| 名称               | 类型   | 字节数 | 说明                                     |
|--------------------+--------+--------+------------------------------------------|
| unreward_denote_id | uint32 |      4 | 未领奖的援助计划id（0：表示没有未领取的 ）                  |
| denote_id          | uint32 |      4 | 当前期援助计划id(0:表示当前暂无援助计划) |
| denote_num         | uint32 |      4 | 已募捐数额                               |
| denoter_num        | uint32 |      4 | 志愿者人数                               |




** 捐款: 40162
*** 请求包
| 名称       | 类型   | 字节数 | 说明           |
|------------+--------+--------+----------------|
| denote_id  | uint32 |      4 | 要援助的计划id |
| denote_num | uint32 |      4 | 捐款数额           |

*** 应答包
| denote_id          | uint32 | 4 | 要援助的计划id                                                                                                           |
| flag               | uint8  | 1 | 0: 募捐成功但计划尚未达成 1：募捐成功并计划达成(用户达成) 2：募捐已结束(别人导致募捐结束) 3:咕咚果不够 4：已达到募捐上限 |
flag =1 和2才有下面的字段
| unreward_denote_id | uint32 | 4 | 未领奖的援助计划id(0表示没有)                                                                                                |
| new_denote_id      | uint32 | 4 | 新的一期援助计划id (0表示没有)                                                                                                       |

** 请求援助概况信息: 40163
*** 请求包
空
*** 应答包
| denote_total | uint32 | 4 | 到目前为止，一共募捐到的咕咚果 |
| helped_pet   | uint16 | 2 | 受帮助过的小精灵数量           |
| total_parti  | uint32 | 4 | 总共参与者人数                        |
| denote_count | uint16 | 2 | 总共已举办的援助计划数 |
| ....         |        |   |                        |
| denote_id    | uint32 | 4 | 援助计划id             |
| reach_time   | uint32 | 4 | 达成时间(0:表示尚在进行中)        |

** 进入博物馆: 40164
*** 请求包
| 名称      | 类型   | 字节数 | 说明 |
|-----------+--------+--------+------|
| museum_id | uint32 | 4      | 博物馆id(必须是配表中存在的) |

*** 应答包
| 名称          | 类型   | 字节数 | 说明                     |
|---------------+--------+--------+--------------------------|
| museum_id     | uint32 |      4 | 博物馆id                    |
| flag          | uint8  |      1 | 是否有奖励(1:没有 0：有) |
| level_id      | uint8  |      1 | flag = 1 表示下一关id  flag=0表示未领取奖品的关卡id |

** 领取博物馆奖励: 40165
*** 请求包
| 名称      | 类型   | 字节数 | 说明     |
|-----------+--------+--------+----------|
| museum_id | uint32 |      4 | 博物馆id |
| level_id  | uint8  |      1 |  未领取奖品的关卡id |

*** 应答包
| 名称          | 类型   | 字节数 | 说明     |
|---------------+--------+--------+----------|
| reward_id     | uint32 |      4 | 奖品id(0:表示没有奖励) |
| reward_num    | uint16 |      2 | 奖品数量 |
| next_level_id | uint8  |      1 | 下一关id    |

** 博物馆答题结束: 40166
*** 请求包
| museum_id | uint32 | 4 | 博物馆id |
| level_id  | uint8  | 1 | 关卡id     |

*** 应答包
| flag          | uint8 | 1 | 是否有奖励(1:没有 0：有) |
| level_id      | uint8 | 1 | flag=1表示下一关id  flag=0表示未领取奖品的关卡id |
|               |       |   |                          |

** 提交蛋糕店游戏的分数:40167
*** 请求包
| game_id  | uint32 | 4 | 游戏id   |
| level_id | uint32 | 4 | 游戏关卡 |
| score    | uint32 | 4 | 分数     |
*** 应答包
| 端午节活动进行时返回包 |       |   |              |
| is_reward              | uint8 | 1 | 能否奖励叶子0：能 1：不能 |
** 更新强制引导标示: 40168
*** 请求包
|guide_flag | uint32| 4| |

*** 应答包
空

** 拉取单个活动的信息: 40169
*** 请求包
| activity_id | uint32 | 4 | 活动id  |
|             |        |   |          |

*** 应答包
| activity_id   | uint32 | 4 | 活动id(公测活动的返回包) |
| reward_kind   | uint16 | 2 | 奖品种类 |
| .....         |        |   |          |
| reward_id     | uint32 | 4 | 奖品id   |
| reward_num    | uint16 | 2 | 奖品数量 |
| reward_status | uint8  | 1 | 奖品状态(0:不可以领取 1：已领取 2：可以领取) |

| 邀请好友活动的返回包 |        |   |                                                            |
| invite_num           | uint16 | 2 | 已经邀请的人数                                             |
| qualitified_num      | uint16 | 2 | 达到5级以上的受邀人数                                      |
| status[3]            | uint8  | 1 | 该活动每一关的状态 0：未完成 1：完成未领奖 2：完成并已领奖 |

| 端午节活动的返回包 |       |   |                                      |
| is_reward          | uint8 | 1 | 是否已经领奖 0：未领 1：已领         |
| status[3]          | uint8 | 1 | 该活动每一关的状态 0：未完成 1：完成 |

** 领取单个活动的奖品: 40170
*** 请求包
| activity_id | uint32 | 4 | 活动id |
| reward_id   | uint32 | 4 | 奖品id |


*** 应答包
| act_id     | uint32 | 4 | 活动id   |
| reward_id  | uint32 | 4 | 奖品id     |
| now_status | uint32 | 4 | 活动状态 |

** 拉取当前活动列表: 40171
*** 请求包
空
*** 应答包
| activity_num    | uint16 | 2 | 活动数量 |
| ...             | ..     |   |          |
| activity_id     | uint32 | 4 | 活动id   |
| activity_status | uint8  | 1 | 活动状态(0:进行中 1：new 2:完成) |


** 领取单个活动的可选择奖品: 40172
*** 请求包
| activity_id | uint32 | 4 | 活动id   |
| level_id    | uint32 | 4 | 关卡id   |
| reward_id   | uint32 | 4 | 奖品id   |
| reward_num  | uint16 | 2 | 奖品数量 |
*** 应答包 


** 兑奖: 40173
*** 请求包
| stuff_A_id | uint32 | 4 | 被兑换物品ID |
| stuff_B_id | uint32 | 4 | 兑换物品ID   | 
用A兑换B  
*** 应答包
| stuff_A_id       | uint32 | 4 | 被兑换物品ID   |
| stuff_b__num     | uint16 | 2 | 被兑换物品数量 |
| stuff_B_id       | uint32 | 4 | 兑换品物ID     |
| stuff_B_category | uint8  | 1 | 兑换物品种类   |
错误码
| 100827：购买的物品id不存在                             |
| 100811：不符合购买物品的条件限制（金币不够或等级不够） |

** 进入大众点评场馆: 40174
*** 请求包 
*** 应答包
| show_id        | uint32   |   4 | 标识本次大众点评是第几期                                    |   |
| show_state     | uint8    |   1 | 本次大众点评的阶段：0参选阶段 1投票阶段                     |   |
| total_num      | uint32   |   4 | 总共报名人数                                                      |   |
| user_num       | uint8    |   1 | 用户数量                                                    |   |
| ...            | ...      | ... | ...                                                         |   |
| user_id        | uint32   |   4 | 米米号                                                      |   |
| user_name      | char(16) |  16 | 用户名字                                                    |   |
| mon_id         | uint32   |   4 | 怪兽形象                                                    |   |
| mon_main_color | uint32   |   4 | 怪兽主颜色                                                  |   |
| mon_exp_color  | uint32   |   4 | 怪兽辅颜色                                                  |   |
| mon_eye_color  | uint32   |   4 | 怪兽眼睛颜色                                                |   |
| npc_score      | uint32   |   4 | 小屋得分                                                    |   |
| npc_timestamp  | uint32   |   4 | 得分的时间戳                                                |   |
| votes          | uint32   |   4 | 得到的票数                                                  |   |
| is_top         | uint8    |   1 | 名次(1:冠军 2：亚军 3， 4， 5， 6)                          |   |
|                | 循环结束 |     |                                                             |   |
| is_join        | uint8    |   1 | 参选解读那代表是否已经报名 投票阶段代表是否已经投票 0否 1是 |   |
| is_notice      | uint8    |   1 | 之前的结果是否已经通知 0:未通知 1：已通知                   |   |
|                |          |     |                                                             |   |
当is_notice=0时有下列字段
| vote_id        | uint32 | 4 | 未通知的大众点评是第几期         |
| reward_type    | uint8  | 1 | 奖品类型: 0:冠军奖 1：猜中冠军奖 |
| reward_coins   | uint32 | 4 | 奖品的金币数                      |

** 参加大众点评海选: 40175
*** 请求包
| show_id | uint16 | 4 | 参与的届数 |
|         |
*** 应答包
空

错误码：
100883:请求的大众点评届数不正确
100884：不是大众点评的报名阶段
100886:小屋今天没有参与评分
100887:已经报过名

** 投票大众点评候选人: 40176
*** 请求包
| show_id   | uint32 | 4 | 投票的届数    |
| candidate | uint32 | 4 | 被选举人 |
*** 应答包
| 端午节活动进行时返回包 |       |   |              |
| is_reward              | uint8 | 1 | 能否奖励叶子0：能 1：不能 |

错误码：
100883：请求的大众点评届数不正确
100885：不是大众点评的投票阶段
100888:已经投过票

** 拉取往届大众点评信息:40177
*** 请求包
| show_id | uint32 | 4 |请求的期数|

*** 应答包
| show_id        | uint32   |   4 | 请求的大众点评是第几期             |   |   |   |
| total_num      | uint32   |   4 | 总共报名人数                             |   |   |   |
| user_num       | uint8    |   1 | 用户数量                           |   |   |   |
| ...            | ...      | ... | ...                                |   |   |   |
| user_id        | uint32   |   4 | 米米号                             |   |   |   |
| user_name      | char(16) |  16 | 用户名字                           |   |   |   |
| mon_id         | uint32   |   4 | 怪兽形象                           |   |   |   |
| mon_main_color | uint32   |   4 | 怪兽主颜色                         |   |   |   |
| mon_exp_color  | uint32   |   4 | 怪兽辅颜色                         |   |   |   |
| mon_eye_color  | uint32   |   4 | 怪兽眼睛颜色                       |   |   |   |
| npc_score      | uint32   |   4 | 小屋得分                           |   |   |   |
| npc_timestamp  | uint32   |   4 | 得分的时间戳                       |   |   |   |
| votes          | uint32   |   4 | 得到的票数                         |   |   |   |
| is_top         | uint8    |   1 | 名次(1:冠军 2：亚军 3， 4， 5， 6) |   |   |   |
|                | 循环结束 |     |                                    |   |   |   |


** 42003-42006用于推送二人益智游戏信息
** 42007 未用
** 42008 告知AS成就项的个数

** 42009 告知as新的成绩(小屋评分 ，每日益智挑战)
*** 请求包
| type      | uint8  | 1 | 类型(1:小屋评分 2：每日挑战) |
| win_num   | uint32 | 4 | 战胜的人数                   |
| total_num | uint32 | 4 | 总公参与的人数               |
| rand_user_id | uint32 | 4 | 随机的一个用户id                    |

** 42010 告知as新的活动状态
***  请求包
| status | uint8 | 1 | 状态值(0:有新的活动 1：有活动奖品可领取 )

** 错误码

| 错误码                                                                       | 说明             |
|------------------------------------------------------------------------------+------------------|
| ERR_SNDBUF_OVERFLOW = 10001,        //发送缓冲区溢出                       |                     |
| ERR_NO_AVAILABLE_ONLINE = 10002,    //暂时没有可用的online服务器             |                  |
| ERR_INVALID_IP  = 10003,            //无效的IP地址                           |                  |
| ERR_USER_ID = 10004,                //米米号不合法                           |                  |
| ERR_MSG_LEN = 10005,                //接收到的消息长度错误                   |                  |
| ERR_MSG_TYPE = 10006,               //消息类型错误                           |                  |
| ERR_SYSTEM_ERR  = 100007,           //未知的系统错误                         |                  |
| ERR_REPEAT_LOGIN    = 100008,       //重复登录到同一台online                 |                  |
| ERR_LOGIN_AT_OTHER  = 100009,       //在其他online登录                       |                  |
| ERR_USER_UNONLINE   = 100010,       //用户已经下线                           |                  |
| ERR_MSG_TIMEOUT = 100011,           //请求服务端超时                         |                  |
| ERR_NET_ERROR   = 100012,           //网络错误 用于同db_proxy同db_server通信 |                  |
| ERR_REPEAT_REQUEST  = 100013,       //重复请求                               |                  |
| ERR_LOGIN_VERIFY_FAILED = 100014,   //米米号密码没通过account验证            |                  |
| ERR_LOGIN_VERIFY_SESSION = 100015,  //登录用户的session不能通过account的验证 |                  |
| ERR_LOGIN_SESSION_FAILED = 100016,  //未通过session验证的请求                |                  |
| ERR_GET_VERIFY_FAILED = 100017,     //获取验证码失败                         |                  |
| ERR_SQL_ERR     = 100018,           //mysql错误                              |                  |
| ERR_SQL_NO_RECORD     = 100019,     //mysql里没有对应的记录                  |                  |
| ERR_ALLOC_USER_CACHE     = 100020,  //分配用户缓存失败                       |                  |


| //100201 -- 100400 为同account平台之间的错误码                  |
| ERR_MSG_ACCOUNT = 100201,           //给account平台发送请求失败 |
|                                                                 |


| //100401 -- 100600 为同switch平台之间的错误码                  |
| ERR_MSG_SWITCH = 100401,            //给switch服务发送请求失败 |


| ERR_MSG_UCOUNT = 100601,            //给唯一数服务发送请求失败 |
|                                                                |


| //100601 -- 100800 为同db-proxy之间的错误码                  |
| ERR_MSG_DB_PROXY = 100601,          //给db-proxy发送请求失败 |
